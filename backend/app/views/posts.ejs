<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Campus Re-Connect</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <!-- inject:css -->
    <link rel="stylesheet" href="stylesheets/style.css">
    <!-- endinject -->
</head>

<body>

    <button class="btn btn-danger" id="logout-btn">LOGOUT</button>
    <a href="/profile/<%= user._id %>">PROFILE</a>
    <a href="/chat">CHAT</a>
    <textarea class="form-control" placeholder="Type Here..." id="post-body"></textarea>
    <button class="btn btn-primary" id="post-btn">POST</button>

    <div id="posts">
    
        <% for(var i = 0; i < posts.length; i++) { %>
        <div class="card col-md-6">
            <% var id = posts[i]._id %>
            <div class="card-heading">
                By <a href="/profile/<%= posts[i].user._id %>"><%= posts[i].user.name %></a> on <%= posts[i].date %>
                <% if(posts[i].user._id == user._id) { %>
                <button class="btn btn-danger del-post" id="dp<%= posts[i]._id %>">DELETE</button> <% } %>
            </div>
            <div class="card-body"><%= posts[i].body %></div>
            <span id="lc<%=id%>"><%=posts[i].likes.length%></span>
            <% if(posts[i].likes.indexOf(user._id) === -1) { %>
            <% var l = "LIKE" } else { %>
            <% var l = "UNLIKE" } %>
            <button class="btn btn-info col-md-2 like" id="l<%=id%>"><%=l%></button>
            <textarea class="form-control" rows="2" placeholder="Comment here..." id="cs<%=id%>"></textarea>
            <button class="btn btn-info col-md-2 comment" id="c<%=id%>">COMMENT</button>
            <div id="cd<%=id%>">
            <% for(var j = posts[i].comments.length - 1; j >= 0 ; j--) { %>
                <div class="card col-md-6">
                    <%= posts[i].comments[j].comment %> by <a href="/profile/<%= posts[i].comments[j].user._id %>"><%= posts[i].comments[j].user.name %></a>
                    <% if(posts[i].comments[j].user._id == user._id) { %>
                    <button class="btn btn-danger del-comm" id="dc<%= posts[i]._id %><%= posts[i].comments[j]._id %>">DELETE</button> <% } %>
                </div>
            <%}%>
            </div>
            <button class="btn btn-info col-md-2 share">SHARE</button>
        </div>
        <% } %>
    
    </div>


    <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="./js/posts.js"></script>
</body>

</html>